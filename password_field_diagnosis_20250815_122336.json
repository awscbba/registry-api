{
  "timestamp": "2025-08-15T12:23:36.823133",
  "database_analysis": {
    "all_fields": [
      "address",
      "createdAt",
      "dateOfBirth",
      "email",
      "emailVerified",
      "failedLoginAttempts",
      "firstName",
      "id",
      "isActive",
      "isAdmin",
      "is_active",
      "lastLoginAt",
      "lastName",
      "passwordHash",
      "password_hash",
      "password_salt",
      "phone",
      "requirePasswordChange",
      "updatedAt"
    ],
    "password_fields": {
      "password_salt": 1,
      "requirePasswordChange": 2,
      "password_hash": 1,
      "passwordHash": 1
    },
    "field_variations": {
      "createdat": [
        "createdAt"
      ],
      "id": [
        "id"
      ],
      "passwordsalt": [
        "password_salt"
      ],
      "isadmin": [
        "isAdmin"
      ],
      "isactive": [
        "isActive",
        "is_active"
      ],
      "lastloginat": [
        "lastLoginAt"
      ],
      "dateofbirth": [
        "dateOfBirth"
      ],
      "emailverified": [
        "emailVerified"
      ],
      "failedloginattempts": [
        "failedLoginAttempts"
      ],
      "requirepasswordchange": [
        "requirePasswordChange"
      ],
      "address": [
        "address"
      ],
      "firstname": [
        "firstName"
      ],
      "updatedat": [
        "updatedAt"
      ],
      "phone": [
        "phone"
      ],
      "passwordhash": [
        "password_hash",
        "passwordHash"
      ],
      "lastname": [
        "lastName"
      ],
      "email": [
        "email"
      ]
    }
  },
  "user_analysis": {
    "has_password_hash_snake": true,
    "has_password_hash_camel": false,
    "has_password_salt_snake": true,
    "has_password_salt_camel": false,
    "password_hash_value": "$2b$12$84BFxWbF4FSl9...",
    "password_salt_value": "",
    "last_modified": "2025-08-15T03:11:11.621Z",
    "failed_login_attempts": "0",
    "require_password_change": false
  },
  "code_analysis": {
    "field_mappings": [
      {
        "file": "tests/test_subscription_update_fix.py",
        "line": 30,
        "content": "    field_mappings = {\"status\": \"status\"}"
      },
      {
        "file": "tests/test_subscription_update_fix.py",
        "line": 101,
        "content": "        field_mappings = {\"status\": \"status\"}"
      },
      {
        "file": "tests/test_subscription_update_fix.py",
        "line": 126,
        "content": "    field_mappings = {\"status\": \"status\"}"
      },
      {
        "file": "tests/test_dynamodb_parameter_fixes.py",
        "line": 34,
        "content": "    field_mappings = {\"name\": \"name\", \"status\": \"status\"}"
      },
      {
        "file": "src/utils/defensive_utils.py",
        "line": 323,
        "content": "    field_mappings = field_mappings or {}"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 424,
        "content": "            field_mappings = {\n                \"first_name\": \"firstName\",\n                \"last_name\": \"lastName\",\n                \"date_of_birth\": \"dateOfBirth\",\n                \"is_admin\": \"isAdmin\",\n                \"is_active\": \"isActive\",\n                \"failed_login_attempts\": \"failedLoginAttempts\",\n                \"account_locked_until\": \"accountLockedUntil\",\n                \"require_password_change\": \"requirePasswordChange\",\n                \"last_password_change\": \"lastPasswordChange\",\n                \"last_login_at\": \"lastLoginAt\",\n            }"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 785,
        "content": "            field_mappings = {\"maxParticipants\": \"maxParticipants\"}"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 942,
        "content": "            field_mappings = {\n                \"status\": \"status\"  # status is a reserved word in DynamoDB\n            }"
      }
    ],
    "password_references": [
      {
        "file": "tests/test_routing_fix.py",
        "line": 207,
        "pattern": "password_hash",
        "context": "\"password_hash\" in person_fields"
      },
      {
        "file": "tests/test_routing_fix.py",
        "line": 208,
        "pattern": "password_hash",
        "context": "), \"PersonCreate must have password_hash field\""
      },
      {
        "file": "tests/test_routing_fix.py",
        "line": 210,
        "pattern": "password_salt",
        "context": "\"password_salt\" in person_fields"
      },
      {
        "file": "tests/test_routing_fix.py",
        "line": 211,
        "pattern": "password_salt",
        "context": "), \"PersonCreate must have password_salt field\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 16,
        "pattern": "password_hash",
        "context": "\"\"\"Test that Person objects reconstructed from DynamoDB include password_hash.\"\"\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 37,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_password_hash\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 37,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_password_hash\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 46,
        "pattern": "password_hash",
        "context": "person, \"password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 47,
        "pattern": "password_hash",
        "context": "), \"Person should have password_hash attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 52,
        "pattern": "password_hash",
        "context": "person.password_hash == \"test_password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 52,
        "pattern": "password_hash",
        "context": "person.password_hash == \"test_password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 53,
        "pattern": "password_hash",
        "context": "), \"password_hash should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 88,
        "pattern": "password_hash",
        "context": "person, \"password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 89,
        "pattern": "password_hash",
        "context": "), \"Person should have password_hash attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 93,
        "pattern": "password_hash",
        "context": "assert person.password_hash is None, \"password_hash should be None when missing\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 93,
        "pattern": "password_hash",
        "context": "assert person.password_hash is None, \"password_hash should be None when missing\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 120,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_password_hash\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 120,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_password_hash\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 139,
        "pattern": "password_hash",
        "context": "person, \"password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 140,
        "pattern": "password_hash",
        "context": "), \"Person should have password_hash attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 145,
        "pattern": "password_hash",
        "context": "person.password_hash == \"test_password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 145,
        "pattern": "password_hash",
        "context": "person.password_hash == \"test_password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 146,
        "pattern": "password_hash",
        "context": "), \"password_hash should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 173,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_password_hash\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 173,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_password_hash\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 190,
        "pattern": "password_hash",
        "context": "\"password_hash\": dynamodb_item.get(\"password_hash\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 190,
        "pattern": "password_hash",
        "context": "\"password_hash\": dynamodb_item.get(\"password_hash\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 196,
        "pattern": "password_hash",
        "context": "\"password_hash\" in person_data"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 197,
        "pattern": "password_hash",
        "context": "), \"person_data should include password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 202,
        "pattern": "password_hash",
        "context": "person_data[\"password_hash\"] == \"test_password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 202,
        "pattern": "password_hash",
        "context": "person_data[\"password_hash\"] == \"test_password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 203,
        "pattern": "password_hash",
        "context": "), \"password_hash should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 210,
        "pattern": "password_hash",
        "context": "del dynamodb_item_no_password[\"password_hash\"]"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 225,
        "pattern": "password_hash",
        "context": "\"password_hash\": dynamodb_item_no_password.get(\"password_hash\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 225,
        "pattern": "password_hash",
        "context": "\"password_hash\": dynamodb_item_no_password.get(\"password_hash\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 231,
        "pattern": "password_hash",
        "context": "\"password_hash\" in person_data_no_password"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 232,
        "pattern": "password_hash",
        "context": "), \"person_data should include password_hash key\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 237,
        "pattern": "password_hash",
        "context": "person_data_no_password[\"password_hash\"] is None"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 238,
        "pattern": "password_hash",
        "context": "), \"password_hash should be None when missing\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 265,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"test_hash_123\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 274,
        "pattern": "password_hash",
        "context": "person, \"password_hash\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 275,
        "pattern": "password_hash",
        "context": "), \"Person should have password_hash attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 279,
        "pattern": "password_hash",
        "context": "assert person.password_hash == \"test_hash_123\", \"password_hash should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 279,
        "pattern": "password_hash",
        "context": "assert person.password_hash == \"test_hash_123\", \"password_hash should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 38,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_password_salt\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 38,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_password_salt\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 49,
        "pattern": "password_salt",
        "context": "person, \"password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 50,
        "pattern": "password_salt",
        "context": "), \"Person should have password_salt attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 55,
        "pattern": "password_salt",
        "context": "person.password_salt == \"test_password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 55,
        "pattern": "password_salt",
        "context": "person.password_salt == \"test_password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 56,
        "pattern": "password_salt",
        "context": "), \"password_salt should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 91,
        "pattern": "password_salt",
        "context": "person, \"password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 92,
        "pattern": "password_salt",
        "context": "), \"Person should have password_salt attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 94,
        "pattern": "password_salt",
        "context": "assert person.password_salt is None, \"password_salt should be None when missing\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 94,
        "pattern": "password_salt",
        "context": "assert person.password_salt is None, \"password_salt should be None when missing\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 121,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_password_salt\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 121,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_password_salt\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 142,
        "pattern": "password_salt",
        "context": "person, \"password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 143,
        "pattern": "password_salt",
        "context": "), \"Person should have password_salt attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 148,
        "pattern": "password_salt",
        "context": "person.password_salt == \"test_password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 148,
        "pattern": "password_salt",
        "context": "person.password_salt == \"test_password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 149,
        "pattern": "password_salt",
        "context": "), \"password_salt should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 174,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_password_salt\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 174,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_password_salt\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 191,
        "pattern": "password_salt",
        "context": "\"password_salt\": dynamodb_item.get(\"password_salt\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 191,
        "pattern": "password_salt",
        "context": "\"password_salt\": dynamodb_item.get(\"password_salt\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 199,
        "pattern": "password_salt",
        "context": "\"password_salt\" in person_data"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 200,
        "pattern": "password_salt",
        "context": "), \"person_data should include password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 205,
        "pattern": "password_salt",
        "context": "person_data[\"password_salt\"] == \"test_password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 205,
        "pattern": "password_salt",
        "context": "person_data[\"password_salt\"] == \"test_password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 206,
        "pattern": "password_salt",
        "context": "), \"password_salt should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 211,
        "pattern": "password_salt",
        "context": "del dynamodb_item_no_password[\"password_salt\"]"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 226,
        "pattern": "password_salt",
        "context": "\"password_salt\": dynamodb_item_no_password.get(\"password_salt\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 226,
        "pattern": "password_salt",
        "context": "\"password_salt\": dynamodb_item_no_password.get(\"password_salt\"),"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 234,
        "pattern": "password_salt",
        "context": "\"password_salt\" in person_data_no_password"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 235,
        "pattern": "password_salt",
        "context": "), \"person_data should include password_salt key\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 240,
        "pattern": "password_salt",
        "context": "person_data_no_password[\"password_salt\"] is None"
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 241,
        "pattern": "password_salt",
        "context": "), \"password_salt should be None when missing\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 266,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"test_salt_456\","
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 277,
        "pattern": "password_salt",
        "context": "person, \"password_salt\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 278,
        "pattern": "password_salt",
        "context": "), \"Person should have password_salt attribute\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 280,
        "pattern": "password_salt",
        "context": "assert person.password_salt == \"test_salt_456\", \"password_salt should match\""
      },
      {
        "file": "tests/test_person_password_reconstruction.py",
        "line": 280,
        "pattern": "password_salt",
        "context": "assert person.password_salt == \"test_salt_456\", \"password_salt should match\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 18,
        "pattern": "password_hash",
        "context": "def test_person_create_model_accepts_password_hash(self):"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 19,
        "pattern": "password_hash",
        "context": "\"\"\"Test that PersonCreate model can accept password_hash field.\"\"\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 35,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"hashed_password_123\","
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 42,
        "pattern": "password_hash",
        "context": "assert person_create.password_hash == \"hashed_password_123\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 43,
        "pattern": "password_hash",
        "context": "assert hasattr(person_create, \"password_hash\")"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 45,
        "pattern": "password_hash",
        "context": "def test_person_update_model_accepts_password_hash(self):"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 46,
        "pattern": "password_hash",
        "context": "\"\"\"Test that PersonUpdate model can accept password_hash field.\"\"\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 50,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"new_hashed_password_456\","
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 57,
        "pattern": "password_hash",
        "context": "assert person_update.password_hash == \"new_hashed_password_456\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 58,
        "pattern": "password_hash",
        "context": "assert hasattr(person_update, \"password_hash\")"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 61,
        "pattern": "password_hash",
        "context": "\"\"\"Test that password_hash is excluded from model dict (security).\"\"\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 76,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"secret_password\","
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 84,
        "pattern": "password_hash",
        "context": "assert \"password_hash\" not in person_dict"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 86,
        "pattern": "password_hash",
        "context": "person_create.password_hash == \"secret_password\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 89,
        "pattern": "password_hash",
        "context": "def test_password_hashing_consistency(self):"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 125,
        "pattern": "password_hash",
        "context": "\"\"\"Test that password_hash is optional in PersonCreate.\"\"\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 144,
        "pattern": "password_hash",
        "context": "assert person_create.password_hash is None"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 147,
        "pattern": "password_hash",
        "context": "\"\"\"Test that password_hash is optional in PersonUpdate.\"\"\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 153,
        "pattern": "password_hash",
        "context": "assert person_update.password_hash is None"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 171,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"hashed_password\","
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 179,
        "pattern": "password_hash",
        "context": "assert person_create.password_hash == \"hashed_password\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 215,
        "pattern": "password_hash",
        "context": "\"password_hash\": hashed_password,  # This was being ignored!"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 218,
        "pattern": "password_hash",
        "context": "# Step 4: Create PersonCreate model (this was the bug - password_hash was excluded)"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 223,
        "pattern": "password_hash",
        "context": "person_create, \"password_hash\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 224,
        "pattern": "password_hash",
        "context": "), \"PersonCreate must have password_hash field\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 226,
        "pattern": "password_hash",
        "context": "person_create.password_hash == hashed_password"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 228,
        "pattern": "password_hash",
        "context": "assert person_create.password_hash is not None, \"Password hash must not be None\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 230,
        "pattern": "password_hash",
        "context": "len(person_create.password_hash) > 20"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 236,
        "pattern": "password_hash",
        "context": "\"password_hash\" not in person_dict"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 239,
        "pattern": "password_hash",
        "context": "person_create.password_hash == hashed_password"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 155,
        "pattern": "password_salt",
        "context": "def test_person_create_with_password_salt(self):"
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 156,
        "pattern": "password_salt",
        "context": "\"\"\"Test that PersonCreate accepts password_salt field.\"\"\""
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 172,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"random_salt_123\","
      },
      {
        "file": "tests/test_password_generation_integration.py",
        "line": 180,
        "pattern": "password_salt",
        "context": "assert person_create.password_salt == \"random_salt_123\""
      },
      {
        "file": "tests/test_auth_service.py",
        "line": 53,
        "pattern": "password_hash",
        "context": "sample_person.password_hash = bcrypt.hashpw("
      },
      {
        "file": "tests/test_auth_service.py",
        "line": 264,
        "pattern": "password_hash",
        "context": "mock_get_person.return_value = sample_person  # No password_hash attribute"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 5,
        "pattern": "password_hash",
        "context": "models were missing password_hash fields, causing passwords to be generated but not saved."
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 16,
        "pattern": "password_hash",
        "context": "\"\"\"Test that Person model has password_hash and password_salt fields.\"\"\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 35,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"hashed_password_123\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 43,
        "pattern": "password_hash",
        "context": "assert hasattr(person, \"password_hash\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 45,
        "pattern": "password_hash",
        "context": "assert person.password_hash == \"hashed_password_123\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 49,
        "pattern": "password_hash",
        "context": "\"\"\"Test that PersonCreate model has password_hash and password_salt fields.\"\"\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 65,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"hashed_password_create\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 73,
        "pattern": "password_hash",
        "context": "assert hasattr(person_create, \"password_hash\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 75,
        "pattern": "password_hash",
        "context": "assert person_create.password_hash == \"hashed_password_create\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 79,
        "pattern": "password_hash",
        "context": "\"\"\"Test that PersonUpdate model has password_hash and password_salt fields.\"\"\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 83,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"hashed_password_update\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 91,
        "pattern": "password_hash",
        "context": "assert hasattr(person_update, \"password_hash\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 93,
        "pattern": "password_hash",
        "context": "assert person_update.password_hash == \"hashed_password_update\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 118,
        "pattern": "password_hash",
        "context": "assert hasattr(person_create, \"password_hash\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 120,
        "pattern": "password_hash",
        "context": "assert person_create.password_hash is None"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 132,
        "pattern": "password_hash",
        "context": "assert hasattr(person_update, \"password_hash\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 134,
        "pattern": "password_hash",
        "context": "assert person_update.password_hash is None"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 153,
        "pattern": "password_hash",
        "context": "\"password_hash\": \"secret_password\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 162,
        "pattern": "password_hash",
        "context": "assert \"password_hash\" not in person_dict"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 165,
        "pattern": "password_hash",
        "context": "person_create.password_hash == \"secret_password\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 172,
        "pattern": "password_hash",
        "context": "update_data = {\"password_hash\": \"new_hashed_password\"}"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 178,
        "pattern": "password_hash",
        "context": "assert person_update.password_hash == \"new_hashed_password\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 186,
        "pattern": "password_hash",
        "context": "This test specifically prevents the bug where password_hash fields"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 193,
        "pattern": "password_hash",
        "context": "\"password_hash\" in person_create_fields"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 194,
        "pattern": "password_hash",
        "context": "), \"PersonCreate missing password_hash field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 202,
        "pattern": "password_hash",
        "context": "\"password_hash\" in person_update_fields"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 203,
        "pattern": "password_hash",
        "context": "), \"PersonUpdate missing password_hash field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 210,
        "pattern": "password_hash",
        "context": "assert \"password_hash\" in person_fields, \"Person missing password_hash field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 210,
        "pattern": "password_hash",
        "context": "assert \"password_hash\" in person_fields, \"Person missing password_hash field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 16,
        "pattern": "password_salt",
        "context": "\"\"\"Test that Person model has password_hash and password_salt fields.\"\"\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 36,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"salt_456\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 44,
        "pattern": "password_salt",
        "context": "assert hasattr(person, \"password_salt\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 46,
        "pattern": "password_salt",
        "context": "assert person.password_salt == \"salt_456\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 49,
        "pattern": "password_salt",
        "context": "\"\"\"Test that PersonCreate model has password_hash and password_salt fields.\"\"\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 66,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"salt_create\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 74,
        "pattern": "password_salt",
        "context": "assert hasattr(person_create, \"password_salt\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 76,
        "pattern": "password_salt",
        "context": "assert person_create.password_salt == \"salt_create\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 79,
        "pattern": "password_salt",
        "context": "\"\"\"Test that PersonUpdate model has password_hash and password_salt fields.\"\"\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 84,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"salt_update\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 92,
        "pattern": "password_salt",
        "context": "assert hasattr(person_update, \"password_salt\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 94,
        "pattern": "password_salt",
        "context": "assert person_update.password_salt == \"salt_update\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 119,
        "pattern": "password_salt",
        "context": "assert hasattr(person_create, \"password_salt\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 121,
        "pattern": "password_salt",
        "context": "assert person_create.password_salt is None"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 133,
        "pattern": "password_salt",
        "context": "assert hasattr(person_update, \"password_salt\")"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 135,
        "pattern": "password_salt",
        "context": "assert person_update.password_salt is None"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 154,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"secret_salt\","
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 163,
        "pattern": "password_salt",
        "context": "assert \"password_salt\" not in person_dict"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 167,
        "pattern": "password_salt",
        "context": "assert person_create.password_salt == \"secret_salt\"  # Still accessible directly"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 196,
        "pattern": "password_salt",
        "context": "\"password_salt\" in person_create_fields"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 197,
        "pattern": "password_salt",
        "context": "), \"PersonCreate missing password_salt field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 205,
        "pattern": "password_salt",
        "context": "\"password_salt\" in person_update_fields"
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 206,
        "pattern": "password_salt",
        "context": "), \"PersonUpdate missing password_salt field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 211,
        "pattern": "password_salt",
        "context": "assert \"password_salt\" in person_fields, \"Person missing password_salt field\""
      },
      {
        "file": "tests/test_password_model_fields.py",
        "line": 211,
        "pattern": "password_salt",
        "context": "assert \"password_salt\" in person_fields, \"Person missing password_salt field\""
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 51,
        "pattern": "password_hash",
        "context": "password_hash = hashed.decode(\"utf-8\")"
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 53,
        "pattern": "password_hash",
        "context": "print(f\"   Password hash: {password_hash[:50]}...\")"
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 57,
        "pattern": "password_hash",
        "context": "admin_password.encode(\"utf-8\"), password_hash.encode(\"utf-8\")"
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 69,
        "pattern": "password_hash",
        "context": "UpdateExpression=\"SET password_hash = :pwd, password_salt = :salt, isAdmin = :admin, is_active = :active, updatedAt = :updated\","
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 71,
        "pattern": "password_hash",
        "context": "\":pwd\": password_hash,"
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 93,
        "pattern": "password_hash",
        "context": "stored_hash = updated_user.get(\"password_hash\", \"\")"
      },
      {
        "file": "scripts/fix_admin_password_exact.py",
        "line": 69,
        "pattern": "password_salt",
        "context": "UpdateExpression=\"SET password_hash = :pwd, password_salt = :salt, isAdmin = :admin, is_active = :active, updatedAt = :updated\","
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 31,
        "pattern": "password_hash",
        "context": "password_hasher = PasswordHasher()"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 56,
        "pattern": "password_hash",
        "context": "f\"      Has Password: {hasattr(person, 'password_hash') and person.password_hash is not None}\""
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 56,
        "pattern": "password_hash",
        "context": "f\"      Has Password: {hasattr(person, 'password_hash') and person.password_hash is not None}\""
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 70,
        "pattern": "password_hash",
        "context": "await create_admin_user(db_service, password_hasher)"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 100,
        "pattern": "password_hash",
        "context": "await reset_admin_password(db_service, existing_admin, password_hasher)"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 107,
        "pattern": "password_hash",
        "context": "async def create_admin_user(db_service, password_hasher):"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 117,
        "pattern": "password_hash",
        "context": "password_hash = password_hasher.hash_password(admin_password)"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 117,
        "pattern": "password_hash",
        "context": "password_hash = password_hasher.hash_password(admin_password)"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 134,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 134,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 149,
        "pattern": "password_hash",
        "context": "async def reset_admin_password(db_service, admin_user, password_hasher):"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 158,
        "pattern": "password_hash",
        "context": "password_hash = password_hasher.hash_password(new_password)"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 158,
        "pattern": "password_hash",
        "context": "password_hash = password_hasher.hash_password(new_password)"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 162,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 162,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 135,
        "pattern": "password_salt",
        "context": "password_salt=\"\",  # Modern hashing doesn't need separate salt"
      },
      {
        "file": "scripts/diagnose_admin_login.py",
        "line": 163,
        "pattern": "password_salt",
        "context": "password_salt=\"\",  # Modern hashing doesn't need separate salt"
      },
      {
        "file": "scripts/diagnose_deployed_api.py",
        "line": 118,
        "pattern": "password_hash",
        "context": "f\"      Has Password: {'password_hash' in user and user['password_hash'] is not None}\""
      },
      {
        "file": "scripts/diagnose_deployed_api.py",
        "line": 118,
        "pattern": "password_hash",
        "context": "f\"      Has Password: {'password_hash' in user and user['password_hash'] is not None}\""
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 50,
        "pattern": "password_hash",
        "context": "f\"      Has Password Hash: {'password_hash' in user and user['password_hash'] is not None}\""
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 50,
        "pattern": "password_hash",
        "context": "f\"      Has Password Hash: {'password_hash' in user and user['password_hash'] is not None}\""
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 59,
        "pattern": "password_hash",
        "context": "if \"password_hash\" in user and user[\"password_hash\"]:"
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 59,
        "pattern": "password_hash",
        "context": "if \"password_hash\" in user and user[\"password_hash\"]:"
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 65,
        "pattern": "password_hash",
        "context": "user[\"password_hash\"].encode(\"utf-8\"),"
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 103,
        "pattern": "password_hash",
        "context": "password_hash = bcrypt.hashpw("
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 127,
        "pattern": "password_hash",
        "context": "\"password_hash\": password_hash,"
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 127,
        "pattern": "password_hash",
        "context": "\"password_hash\": password_hash,"
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 140,
        "pattern": "password_hash",
        "context": "print(f\"      Password Hash: {password_hash[:50]}...\")"
      },
      {
        "file": "scripts/diagnose_admin.py",
        "line": 128,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"\","
      },
      {
        "file": "scripts/generate_password_hash.py",
        "line": 10,
        "pattern": "password_hash",
        "context": "def generate_password_hash():"
      },
      {
        "file": "scripts/generate_password_hash.py",
        "line": 19,
        "pattern": "password_hash",
        "context": "password_hash = hashed.decode(\"utf-8\")"
      },
      {
        "file": "scripts/generate_password_hash.py",
        "line": 22,
        "pattern": "password_hash",
        "context": "print(f\"Hash: {password_hash}\")"
      },
      {
        "file": "scripts/generate_password_hash.py",
        "line": 25,
        "pattern": "password_hash",
        "context": "if bcrypt.checkpw(password.encode(\"utf-8\"), password_hash.encode(\"utf-8\")):"
      },
      {
        "file": "scripts/generate_password_hash.py",
        "line": 40,
        "pattern": "password_hash",
        "context": "return password_hash"
      },
      {
        "file": "scripts/generate_password_hash.py",
        "line": 44,
        "pattern": "password_hash",
        "context": "generate_password_hash()"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 28,
        "pattern": "password_hash",
        "context": "password_hasher = PasswordHasher()"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 58,
        "pattern": "password_hash",
        "context": "password_hash, password_salt = password_hasher.hash_password(admin_password)"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 58,
        "pattern": "password_hash",
        "context": "password_hash, password_salt = password_hasher.hash_password(admin_password)"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 77,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 77,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 112,
        "pattern": "password_hash",
        "context": "password_hasher = PasswordHasher()"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 142,
        "pattern": "password_hash",
        "context": "password_hash, password_salt = password_hasher.hash_password("
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 142,
        "pattern": "password_hash",
        "context": "password_hash, password_salt = password_hasher.hash_password("
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 163,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 163,
        "pattern": "password_hash",
        "context": "password_hash=password_hash,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 58,
        "pattern": "password_salt",
        "context": "password_hash, password_salt = password_hasher.hash_password(admin_password)"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 78,
        "pattern": "password_salt",
        "context": "password_salt=password_salt,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 78,
        "pattern": "password_salt",
        "context": "password_salt=password_salt,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 142,
        "pattern": "password_salt",
        "context": "password_hash, password_salt = password_hasher.hash_password("
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 164,
        "pattern": "password_salt",
        "context": "password_salt=password_salt,"
      },
      {
        "file": "scripts/create_admin_user.py",
        "line": 164,
        "pattern": "password_salt",
        "context": "password_salt=password_salt,"
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 51,
        "pattern": "password_hash",
        "context": "password_hash = bcrypt.hashpw("
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 60,
        "pattern": "password_hash",
        "context": "UpdateExpression=\"SET password_hash = :pwd, isAdmin = :admin, is_active = :active, updatedAt = :updated\","
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 62,
        "pattern": "password_hash",
        "context": "\":pwd\": password_hash,"
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 76,
        "pattern": "password_hash",
        "context": "password_hash = bcrypt.hashpw("
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 97,
        "pattern": "password_hash",
        "context": "\"password_hash\": password_hash,"
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 97,
        "pattern": "password_hash",
        "context": "\"password_hash\": password_hash,"
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 110,
        "pattern": "password_hash",
        "context": "admin_password.encode(\"utf-8\"), password_hash.encode(\"utf-8\")"
      },
      {
        "file": "scripts/fix_admin_user.py",
        "line": 98,
        "pattern": "password_salt",
        "context": "\"password_salt\": \"\","
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 378,
        "pattern": "password_hash",
        "context": "not hasattr(existing_person, \"password_hash\")"
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 379,
        "pattern": "password_hash",
        "context": "or not existing_person.password_hash"
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 393,
        "pattern": "password_hash",
        "context": "person_update = PersonUpdate(password_hash=hashed_password)"
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 450,
        "pattern": "password_hash",
        "context": "person_data[\"password_hash\"] = hashed_password"
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 615,
        "pattern": "password_hash",
        "context": "if not hasattr(person, \"password_hash\") or not person.password_hash:"
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 615,
        "pattern": "password_hash",
        "context": "if not hasattr(person, \"password_hash\") or not person.password_hash:"
      },
      {
        "file": "migration_backup/versioned_api_handler_backup_20250811_154450.py",
        "line": 632,
        "pattern": "password_hash",
        "context": "login_request.password, person.password_hash"
      },
      {
        "file": "src/utils/defensive_utils.py",
        "line": 375,
        "pattern": "password_hash",
        "context": "\"password_hash\","
      },
      {
        "file": "src/utils/defensive_utils.py",
        "line": 376,
        "pattern": "password_salt",
        "context": "\"password_salt\","
      },
      {
        "file": "src/utils/password_utils.py",
        "line": 180,
        "pattern": "password_hash",
        "context": "def add_to_history(current_history: List[str], new_password_hash: str) -> List[str]:"
      },
      {
        "file": "src/utils/password_utils.py",
        "line": 186,
        "pattern": "password_hash",
        "context": "new_password_hash: New password hash to add"
      },
      {
        "file": "src/utils/password_utils.py",
        "line": 195,
        "pattern": "password_hash",
        "context": "updated_history = [new_password_hash] + current_history"
      },
      {
        "file": "src/repositories/user_repository.py",
        "line": 53,
        "pattern": "password_hash",
        "context": "\"password_hash\": item.get(\"password_hash\"),"
      },
      {
        "file": "src/repositories/user_repository.py",
        "line": 53,
        "pattern": "password_hash",
        "context": "\"password_hash\": item.get(\"password_hash\"),"
      },
      {
        "file": "src/repositories/user_repository.py",
        "line": 90,
        "pattern": "password_hash",
        "context": "\"password_hash\","
      },
      {
        "file": "src/repositories/user_repository.py",
        "line": 54,
        "pattern": "password_salt",
        "context": "\"password_salt\": item.get(\"password_salt\"),"
      },
      {
        "file": "src/repositories/user_repository.py",
        "line": 54,
        "pattern": "password_salt",
        "context": "\"password_salt\": item.get(\"password_salt\"),"
      },
      {
        "file": "src/repositories/user_repository.py",
        "line": 91,
        "pattern": "password_salt",
        "context": "\"password_salt\","
      },
      {
        "file": "src/models/person.py",
        "line": 29,
        "pattern": "password_hash",
        "context": "password_hash: Optional[str] = Field(None, exclude=True)"
      },
      {
        "file": "src/models/person.py",
        "line": 49,
        "pattern": "password_hash",
        "context": "password_hash: Optional[str] = Field(None, exclude=True)"
      },
      {
        "file": "src/models/person.py",
        "line": 59,
        "pattern": "password_hash",
        "context": "password_hash: Optional[str] = Field("
      },
      {
        "file": "src/models/person.py",
        "line": 97,
        "pattern": "password_hash",
        "context": "hasattr(person_data, \"password_hash\")"
      },
      {
        "file": "src/models/person.py",
        "line": 98,
        "pattern": "password_hash",
        "context": "and person_data.password_hash is not None"
      },
      {
        "file": "src/models/person.py",
        "line": 100,
        "pattern": "password_hash",
        "context": "person_dict[\"password_hash\"] = person_data.password_hash"
      },
      {
        "file": "src/models/person.py",
        "line": 100,
        "pattern": "password_hash",
        "context": "person_dict[\"password_hash\"] = person_data.password_hash"
      },
      {
        "file": "src/models/person.py",
        "line": 30,
        "pattern": "password_salt",
        "context": "password_salt: Optional[str] = Field(None, exclude=True)"
      },
      {
        "file": "src/models/person.py",
        "line": 50,
        "pattern": "password_salt",
        "context": "password_salt: Optional[str] = Field(None, exclude=True)"
      },
      {
        "file": "src/models/person.py",
        "line": 62,
        "pattern": "password_salt",
        "context": "password_salt: Optional[str] = Field("
      },
      {
        "file": "src/models/person.py",
        "line": 102,
        "pattern": "password_salt",
        "context": "hasattr(person_data, \"password_salt\")"
      },
      {
        "file": "src/models/person.py",
        "line": 103,
        "pattern": "password_salt",
        "context": "and person_data.password_salt is not None"
      },
      {
        "file": "src/models/person.py",
        "line": 105,
        "pattern": "password_salt",
        "context": "person_dict[\"password_salt\"] = person_data.password_salt"
      },
      {
        "file": "src/models/person.py",
        "line": 105,
        "pattern": "password_salt",
        "context": "person_dict[\"password_salt\"] = person_data.password_salt"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 387,
        "pattern": "password_hash",
        "context": "not hasattr(existing_person, \"password_hash\")"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 388,
        "pattern": "password_hash",
        "context": "or not existing_person.password_hash"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 402,
        "pattern": "password_hash",
        "context": "person_update = PersonUpdate(password_hash=hashed_password)"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 459,
        "pattern": "password_hash",
        "context": "person_data[\"password_hash\"] = hashed_password"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 747,
        "pattern": "password_hash",
        "context": "if not hasattr(person, \"password_hash\") or not person.password_hash:"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 747,
        "pattern": "password_hash",
        "context": "if not hasattr(person, \"password_hash\") or not person.password_hash:"
      },
      {
        "file": "src/handlers/versioned_api_handler.py",
        "line": 764,
        "pattern": "password_hash",
        "context": "login_request.password, person.password_hash"
      },
      {
        "file": "src/services/auth_service.py",
        "line": 172,
        "pattern": "password_hash",
        "context": "if not hasattr(person, \"password_hash\") or not person.password_hash:"
      },
      {
        "file": "src/services/auth_service.py",
        "line": 172,
        "pattern": "password_hash",
        "context": "if not hasattr(person, \"password_hash\") or not person.password_hash:"
      },
      {
        "file": "src/services/auth_service.py",
        "line": 184,
        "pattern": "password_hash",
        "context": "login_request.password, person.password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 202,
        "pattern": "password_hash",
        "context": "password_hash = safe_field_access(person, \"password_hash\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 202,
        "pattern": "password_hash",
        "context": "password_hash = safe_field_access(person, \"password_hash\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 203,
        "pattern": "password_hash",
        "context": "if password_hash:"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 204,
        "pattern": "password_hash",
        "context": "item[\"passwordHash\"] = password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 257,
        "pattern": "password_hash",
        "context": "\"password_hash\": item.get(\"passwordHash\"),"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 284,
        "pattern": "password_hash",
        "context": "if item.get(\"password_hash\"):"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 285,
        "pattern": "password_hash",
        "context": "person.password_hash = item[\"password_hash\"]"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 285,
        "pattern": "password_hash",
        "context": "person.password_hash = item[\"password_hash\"]"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 332,
        "pattern": "password_hash",
        "context": "hasattr(person_data, \"password_hash\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 333,
        "pattern": "password_hash",
        "context": "and person_data.password_hash is not None"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 335,
        "pattern": "password_hash",
        "context": "person_dict[\"password_hash\"] = person_data.password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 335,
        "pattern": "password_hash",
        "context": "person_dict[\"password_hash\"] = person_data.password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 409,
        "pattern": "password_hash",
        "context": "hasattr(person_update, \"password_hash\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 410,
        "pattern": "password_hash",
        "context": "and person_update.password_hash is not None"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 412,
        "pattern": "password_hash",
        "context": "update_data[\"password_hash\"] = person_update.password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 412,
        "pattern": "password_hash",
        "context": "update_data[\"password_hash\"] = person_update.password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 678,
        "pattern": "password_hash",
        "context": "password_hash: Optional[str] = None,"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 688,
        "pattern": "password_hash",
        "context": "if password_hash is not None:"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 689,
        "pattern": "password_hash",
        "context": "update_expression_parts.append(\"passwordHash = :password_hash\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 690,
        "pattern": "password_hash",
        "context": "expression_values[\":password_hash\"] = password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 690,
        "pattern": "password_hash",
        "context": "expression_values[\":password_hash\"] = password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 204,
        "pattern": "passwordHash",
        "context": "item[\"passwordHash\"] = password_hash"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 257,
        "pattern": "passwordHash",
        "context": "\"password_hash\": item.get(\"passwordHash\"),"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 689,
        "pattern": "passwordHash",
        "context": "update_expression_parts.append(\"passwordHash = :password_hash\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 206,
        "pattern": "password_salt",
        "context": "password_salt = safe_field_access(person, \"password_salt\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 206,
        "pattern": "password_salt",
        "context": "password_salt = safe_field_access(person, \"password_salt\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 207,
        "pattern": "password_salt",
        "context": "if password_salt:"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 208,
        "pattern": "password_salt",
        "context": "item[\"passwordSalt\"] = password_salt"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 258,
        "pattern": "password_salt",
        "context": "\"password_salt\": item.get(\"passwordSalt\"),"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 286,
        "pattern": "password_salt",
        "context": "if item.get(\"password_salt\"):"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 287,
        "pattern": "password_salt",
        "context": "person.password_salt = item[\"password_salt\"]"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 287,
        "pattern": "password_salt",
        "context": "person.password_salt = item[\"password_salt\"]"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 337,
        "pattern": "password_salt",
        "context": "hasattr(person_data, \"password_salt\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 338,
        "pattern": "password_salt",
        "context": "and person_data.password_salt is not None"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 340,
        "pattern": "password_salt",
        "context": "person_dict[\"password_salt\"] = person_data.password_salt"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 340,
        "pattern": "password_salt",
        "context": "person_dict[\"password_salt\"] = person_data.password_salt"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 414,
        "pattern": "password_salt",
        "context": "hasattr(person_update, \"password_salt\")"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 415,
        "pattern": "password_salt",
        "context": "and person_update.password_salt is not None"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 417,
        "pattern": "password_salt",
        "context": "update_data[\"password_salt\"] = person_update.password_salt"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 417,
        "pattern": "password_salt",
        "context": "update_data[\"password_salt\"] = person_update.password_salt"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 208,
        "pattern": "passwordSalt",
        "context": "item[\"passwordSalt\"] = password_salt"
      },
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 258,
        "pattern": "passwordSalt",
        "context": "\"password_salt\": item.get(\"passwordSalt\"),"
      },
      {
        "file": "src/services/password_reset_service.py",
        "line": 216,
        "pattern": "password_hash",
        "context": "password_hash = bcrypt.hashpw("
      },
      {
        "file": "src/services/password_reset_service.py",
        "line": 224,
        "pattern": "password_hash",
        "context": "\"password_hash\": password_hash,"
      },
      {
        "file": "src/services/password_reset_service.py",
        "line": 224,
        "pattern": "password_hash",
        "context": "\"password_hash\": password_hash,"
      },
      {
        "file": ".venv/lib/python3.13/site-packages/werkzeug/security.py",
        "line": 73,
        "pattern": "password_hash",
        "context": "def generate_password_hash("
      },
      {
        "file": ".venv/lib/python3.13/site-packages/werkzeug/security.py",
        "line": 77,
        "pattern": "password_hash",
        "context": "using :func:`check_password_hash`."
      },
      {
        "file": ".venv/lib/python3.13/site-packages/werkzeug/security.py",
        "line": 112,
        "pattern": "password_hash",
        "context": "def check_password_hash(pwhash: str, password: str) -> bool:"
      },
      {
        "file": ".venv/lib/python3.13/site-packages/werkzeug/security.py",
        "line": 114,
        "pattern": "password_hash",
        "context": ":func:`generate_password_hash`, matches the given password."
      },
      {
        "file": ".venv/lib/python3.13/site-packages/pygments/lexers/_php_builtins.py",
        "line": 2027,
        "pattern": "password_hash",
        "context": "'password_hash',"
      }
    ],
    "update_expressions": [
      {
        "file": "src/services/defensive_dynamodb_service.py",
        "line": 689,
        "content": "update_expression_parts.append(\"passwordHash = :password_hash\")"
      }
    ],
    "model_definitions": []
  },
  "tokens_analysis": {
    "total_tokens": 10,
    "used_tokens": 0,
    "expired_tokens": 2,
    "valid_tokens": 0,
    "field_names": "{'createdAt', 'personId', 'userAgent', 'ipAddress', 'expiresAt', 'isUsed', 'resetToken', 'email'}"
  },
  "standardization_recommendation": {
    "standard": "snake_case",
    "password_field": "password_hash",
    "salt_field": "password_salt"
  },
  "issues": [
    {
      "category": "FIELD_NAMING",
      "description": "Multiple naming variations for 'isactive': ['isActive', 'is_active']",
      "severity": "HIGH",
      "timestamp": "2025-08-15T12:23:31.266893"
    },
    {
      "category": "FIELD_NAMING",
      "description": "Multiple naming variations for 'passwordhash': ['password_hash', 'passwordHash']",
      "severity": "HIGH",
      "timestamp": "2025-08-15T12:23:31.266917"
    },
    {
      "category": "FIELD_NAMING",
      "description": "Both 'password_hash' and 'passwordHash' fields exist - major inconsistency",
      "severity": "CRITICAL",
      "timestamp": "2025-08-15T12:23:31.266924"
    }
  ],
  "recommendations": [
    {
      "category": "FIELD_NAMING",
      "description": "Standardize all password fields to snake_case",
      "action": "Update all code to use 'password_hash' and 'password_salt'"
    },
    {
      "category": "DATABASE_MIGRATION",
      "description": "Migrate database records to use consistent field names",
      "action": "Create migration script to rename fields to snake_case format"
    },
    {
      "category": "CODE_UPDATES",
      "description": "Update all field mappings and update expressions",
      "action": "Fix field_mappings dictionary and update_expression_parts in DefensiveDynamoDBService"
    },
    {
      "category": "TESTING",
      "description": "Create comprehensive tests for password operations",
      "action": "Test password reset, authentication, and field updates after standardization"
    }
  ]
}
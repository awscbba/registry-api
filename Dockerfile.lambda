FROM public.ecr.aws/lambda/python:3.9

# Install uv for dependency management
RUN pip install uv

# Copy dependency files
COPY requirements-lambda.txt ./
COPY pyproject.toml ./

# Install dependencies using the Lambda-specific requirements file
RUN uv pip install --system --python-version 3.9 -r requirements-lambda.txt

# Copy application code
COPY main.py ./
COPY src/ ./src/

# Set the CMD to the Service Registry handler with complete functionality
CMD ["main.lambda_handler"]
